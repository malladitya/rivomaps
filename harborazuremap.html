<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harbor - Navigate with Peace</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        harbor: { 50: '#f0fdfa', 500: '#14b8a6', 600: '#0d9488', 900: '#134e4a' }
                    }
                }
            }
        }
    </script>
    
    <style>
        #map { width: 100%; height: 100%; z-index: 1; border-radius: 1rem; }
        /* Fix for Leaflet controls looking weird in some tailwind setups */
        .leaflet-pane { z-index: 1 !important; }
        .leaflet-control { z-index: 10 !important; }
    </style>
</head>

<body>
    <div id="site-header-placeholder"></div>

    <section id="demo" class="py-12 relative min-h-screen bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100 flex flex-col lg:flex-row h-screen lg:h-[700px] max-h-[90vh]">
                
                <div class="w-full lg:w-1/3 p-6 lg:p-8 flex flex-col border-r border-gray-100 z-20 overflow-y-auto bg-white">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Plan a Calm Route</h2>
                    
                    <div class="space-y-4 mb-6">
                        <input type="text" id="startInput" class="block w-full p-3 border rounded-xl bg-gray-50" placeholder="Current Location" value="Sector 1, CGC Landran">
                        <input type="text" id="endInput" class="block w-full p-3 border rounded-xl bg-gray-50" placeholder="Destination" value="Sukhna Lake, Chandigarh">
                    </div>

                    <div class="space-y-6 mb-8">
                        <div>
                            <label class="text-sm font-medium text-gray-900">Noise Tolerance</label>
                            <input type="range" class="w-full h-2 bg-gray-200 rounded-lg cursor-pointer" min="1" max="100">
                            <div class="flex justify-between text-xs text-gray-400 mt-1"><span>Silent</span><span>Lively</span></div>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="checkbox" id="avoidCrowds" checked class="w-4 h-4 text-harbor-500 rounded">
                            <label for="avoidCrowds" class="text-sm text-gray-700">Avoid Crowds</label>
                        </div>
                    </div>

                    <div class="mt-auto space-y-3">
                        <button id="addNoiseBtn" class="w-full py-2 bg-orange-100 text-orange-700 rounded-lg text-sm font-medium">
                            <i class="fa-solid fa-bullhorn mr-2"></i> Simulate Noise Source
                        </button>
                        <button id="findRouteBtn" class="w-full bg-harbor-500 hover:bg-harbor-600 text-white font-bold py-4 rounded-xl shadow-md transition-all">
                            Find Comfortable Route
                        </button>
                    </div>
                </div>

                <div class="relative w-full lg:w-2/3 h-full bg-gray-100">
                    <div id="map"></div>
                    
                    <div id="routeStats" class="absolute bottom-6 left-6 z-[400] bg-white/95 backdrop-blur px-4 py-3 rounded-xl shadow-lg border border-gray-100 hidden">
                        <div class="flex items-center gap-2 text-harbor-900 font-medium">
                            <i class="fa-solid fa-route text-harbor-500"></i>
                            <span id="routeDistance">Calculating...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
 <div id="site-footer-placeholder"></div>
    <script src="layout.js"> </script>
    <script>
        // --- 1. SETUP MAP ---
        // Coordinates for Chandigarh area
        const startCoords = [30.7333, 76.7794]; 
        
        // Initialize Leaflet Map (Free, No Key)
        var map = L.map('map').setView(startCoords, 13);

        // Add OpenStreetMap Tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Â© OpenStreetMap'
        }).addTo(map);

        // Define Icons
        var harborIcon = L.divIcon({
            className: 'custom-div-icon',
            html: "<div style='background-color:#0EA5A2; width:15px; height:15px; border-radius:50%; border:2px solid white; box-shadow:0 0 5px rgba(0,0,0,0.3);'></div>",
            iconSize: [15, 15],
            iconAnchor: [7, 7]
        });

        // Add Markers
        var startMarker = L.marker([30.755, 76.8], {icon: harborIcon}).addTo(map).bindPopup("Start: CGC Landran");
        var endMarker = L.marker([30.74, 76.78], {icon: harborIcon}).addTo(map).bindPopup("End: Sukhna Lake");

        // Global storage for circles
        var noiseCircles = [];
        var routePolyline = null;

        // --- 2. ADD FAKE ZONES (DEMO DATA) ---
        function addDemoZones() {
            // A "Noisy" Red Zone
            var circle = L.circle([30.745, 76.79], {
                color: '#EF4444',
                fillColor: '#EF4444',
                fillOpacity: 0.3,
                radius: 400
            }).addTo(map);
            noiseCircles.push(circle);

            // A "Quiet" Green Zone
            var quietCircle = L.circle([30.750, 76.785], {
                color: '#10B981',
                fillColor: '#10B981',
                fillOpacity: 0.2,
                radius: 300
            }).addTo(map);
        }
        addDemoZones();

        // --- 3. HANDLE CLICKS & ROUTING ---
        document.getElementById('addNoiseBtn').addEventListener('click', function() {
            alert("Click anywhere on the map to add a NOISE zone.");
            map.once('click', function(e) {
                L.circle(e.latlng, {
                    color: '#F97316', // Orange
                    fillColor: '#F97316',
                    fillOpacity: 0.4,
                    radius: 300
                }).addTo(map);
            });
        });

        document.getElementById('findRouteBtn').addEventListener('click', function() {
            // Clear old route
            if (routePolyline) map.removeLayer(routePolyline);

            // Mock Route Coordinates (A curved line to look realistic)
            // You can replace these numbers to match your city better
            var latlngs = [
                [30.755, 76.8],
                [30.752, 76.795],
                [30.748, 76.792], // Curves around the noise zone
                [30.742, 76.785],
                [30.74, 76.78]
            ];

            // Draw the line
            routePolyline = L.polyline(latlngs, {color: '#0EA5A2', weight: 5}).addTo(map);
            map.fitBounds(routePolyline.getBounds());

            // Show stats
            document.getElementById('routeStats').classList.remove('hidden');
            document.getElementById('routeDistance').innerText = "1.4 km (Quiet Route Found)";
        });

    </script>
</body>
</html>
