<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Understanding Demo - Rivo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0EA5A2 0%, #06B6D4 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .demo-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .demo-card h2 {
            color: #0EA5A2;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #0EA5A2;
            padding-bottom: 10px;
        }

        .demo-card input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: 'Poppins', sans-serif;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .demo-card button {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #0EA5A2 0%, #06B6D4 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .demo-card button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(14, 165, 162, 0.3);
        }

        .output {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
            max-height: 300px;
            overflow-y: auto;
            font-size: 13px;
            font-family: 'Courier New', monospace;
        }

        .output-item {
            margin-bottom: 10px;
            padding: 8px;
            background: white;
            border-left: 3px solid #0EA5A2;
            border-radius: 3px;
        }

        .output-item.user {
            background: #e8f4f8;
            border-left-color: #0EA5A2;
        }

        .output-item.ai {
            background: #f0f9ff;
            border-left-color: #06B6D4;
        }

        .output-item.error {
            background: #ffe8e8;
            border-left-color: #d32f2f;
            color: #d32f2f;
        }

        .label {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            display: block;
        }

        .intent-badge {
            display: inline-block;
            background: #0EA5A2;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            margin-right: 5px;
            margin-top: 5px;
        }

        .confidence-bar {
            background: #ddd;
            height: 8px;
            border-radius: 4px;
            margin: 8px 0;
            overflow: hidden;
        }

        .confidence-fill {
            background: linear-gradient(90deg, #0EA5A2 0%, #06B6D4 100%);
            height: 100%;
            transition: width 0.3s;
        }

        .examples {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-top: 20px;
        }

        .examples h2 {
            color: #0EA5A2;
            margin-bottom: 15px;
        }

        .example-btn {
            display: inline-block;
            background: #0EA5A2;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            font-size: 13px;
            border: none;
            transition: all 0.3s;
        }

        .example-btn:hover {
            background: #06B6D4;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Rivo AI-Powered Understanding Demo</h1>
            <p>Real-time Natural Language Processing for Navigation</p>
        </div>

        <div class="demo-grid">
            <!-- AI Understanding Demo -->
            <div class="demo-card">
                <h2>üí¨ AI Understanding Engine</h2>
                <label class="label">Your Message:</label>
                <input type="text" id="userInput" placeholder="e.g., 'Take me from Sector 7 to the airport avoiding noise'" />
                <button onclick="processMessage()">Process Message</button>

                <label class="label" style="margin-top: 15px;">AI Analysis:</label>
                <div class="output" id="analysisOutput">
                    <div class="output-item">AI is ready. Try a message above.</div>
                </div>
            </div>

            <!-- Intent Recognition Demo -->
            <div class="demo-card">
                <h2>üéØ Intent Recognition</h2>
                <label class="label">Detected Intent:</label>
                <div class="output" id="intentOutput" style="margin-bottom: 15px;">
                    <div class="output-item">Waiting for input...</div>
                </div>

                <label class="label">Extracted Entities:</label>
                <div class="output" id="entityOutput">
                    <div class="output-item">Locations, coordinates, and preferences will appear here</div>
                </div>
            </div>
        </div>

        <!-- Conversation History -->
        <div class="demo-card">
            <h2>üìù Conversation History</h2>
            <div class="output" id="conversationOutput" style="height: 200px;">
                <div class="output-item">Conversation history will appear here</div>
            </div>
            <button onclick="clearHistory()" style="margin-top: 10px; background: #d32f2f;">Clear History</button>
        </div>

        <!-- Examples -->
        <div class="examples">
            <h2>üìö Try These Examples</h2>
            <p style="margin-bottom: 15px; color: #666;">Click any example to see how the AI understands it:</p>
            
            <button class="example-btn" onclick="setExample('My location is 28.6692, 77.4538')">üìç Set Location</button>
            <button class="example-btn" onclick="setExample('Take me to Delhi')">üó∫Ô∏è Set Destination</button>
            <button class="example-btn" onclick="setExample('Navigate to Sector 17 avoiding crowds')">üöÄ Full Navigation</button>
            <button class="example-btn" onclick="setExample('How comfortable is this route?')">üòä Check Comfort</button>
            <button class="example-btn" onclick="setExample('Start navigation')">‚ñ∂Ô∏è Start Nav</button>
            <button class="example-btn" onclick="setExample('What can you do?')">‚ùì Help</button>
            <button class="example-btn" onclick="setExample('Avoid noisy areas')">üö´ Avoid Area</button>
            <button class="example-btn" onclick="setExample('I prefer comfortable routes')">‚öôÔ∏è Set Preference</button>
        </div>
    </div>

    <script src="ai-nlp-engine.js"></script>
    <script>
        let aiEngine = null;

        // Initialize AI Engine
        window.addEventListener('load', function() {
            if (typeof AIUnderstandingEngine !== 'undefined') {
                aiEngine = new AIUnderstandingEngine();
                console.log('‚úÖ AI Understanding Engine loaded successfully!');
                updateStatus('AI Engine Ready! ‚úÖ');
            } else {
                console.error('‚ùå AI Engine not loaded');
                updateStatus('AI Engine not loaded. Check console.');
            }
        });

        function processMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();

            if (!message) {
                alert('Please enter a message');
                return;
            }

            if (!aiEngine) {
                alert('AI Engine not loaded yet');
                return;
            }

            // Process message
            const response = aiEngine.processUserMessage(message);

            // Update UI with analysis
            displayAnalysis(message, response);
            displayIntent(response);
            displayEntities(response);
            displayConversation();

            // Clear input
            input.value = '';
            input.focus();
        }

        function displayAnalysis(message, response) {
            const output = document.getElementById('analysisOutput');
            output.innerHTML = '';

            // User message
            const userDiv = document.createElement('div');
            userDiv.className = 'output-item user';
            userDiv.innerHTML = `<strong>üë§ User:</strong> "${message}"`;
            output.appendChild(userDiv);

            // AI Response
            const aiDiv = document.createElement('div');
            aiDiv.className = 'output-item ai';
            aiDiv.innerHTML = `<strong>ü§ñ AI:</strong> ${response.message}`;
            output.appendChild(aiDiv);

            // Intent details
            const intentDiv = document.createElement('div');
            intentDiv.className = 'output-item';
            intentDiv.innerHTML = `
                <strong>Intent:</strong> ${response.intent}<br>
                <strong>Confidence:</strong> ${(response.confidence * 100).toFixed(0)}%
                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: ${response.confidence * 100}%"></div>
                </div>
            `;
            output.appendChild(intentDiv);

            // Action taken
            if (response.action) {
                const actionDiv = document.createElement('div');
                actionDiv.className = 'output-item';
                actionDiv.innerHTML = `<strong>üéØ Action:</strong> ${response.action}`;
                output.appendChild(actionDiv);
            }
        }

        function displayIntent(response) {
            const output = document.getElementById('intentOutput');
            output.innerHTML = '';

            const intents = {
                'SET_LOCATION': 'üìç Setting Current Location',
                'SET_DESTINATION': 'üó∫Ô∏è Setting Destination',
                'GET_ROUTE': 'üõ£Ô∏è Getting Route',
                'GET_COMFORT': 'üòä Checking Comfort Level',
                'START_NAV': '‚ñ∂Ô∏è Starting Navigation',
                'AVOID_AREA': 'üö´ Adding Area to Avoid',
                'PREFERENCE': '‚öôÔ∏è Setting Preference',
                'HELP': '‚ùì Showing Help',
                'GREET': 'üëã Greeting',
                'CHECK_TIME': '‚è±Ô∏è Checking Time',
                'UNKNOWN': '‚ùì Unknown Intent'
            };

            const intentDiv = document.createElement('div');
            intentDiv.className = 'output-item';
            intentDiv.innerHTML = `
                <strong>Detected Intent:</strong><br>
                <span class="intent-badge">${intents[response.intent] || response.intent}</span>
                <br><br>
                <strong>Confidence Score:</strong><br>
                ${(response.confidence * 100).toFixed(1)}%
            `;
            output.appendChild(intentDiv);
        }

        function displayEntities(response) {
            const output = document.getElementById('entityOutput');
            output.innerHTML = '';

            const prefs = response.preferences || {};

            const entDiv = document.createElement('div');
            entDiv.className = 'output-item';

            let html = '<strong>User Preferences & Extracted Data:</strong><br>';
            html += `üìç <strong>Origin:</strong> ${prefs.origin ? JSON.stringify(prefs.origin) : 'Not set'}<br>`;
            html += `üó∫Ô∏è <strong>Destination:</strong> ${prefs.destination ? JSON.stringify(prefs.destination) : 'Not set'}<br>`;
            html += `‚öôÔ∏è <strong>Preference:</strong> ${prefs.preferenceType || 'Default'}<br>`;
            html += `üöó <strong>Modes:</strong> ${(prefs.selectedModes || []).join(', ') || 'Walking'}<br>`;
            html += `üö´ <strong>Avoid Areas:</strong> ${prefs.avoidAreas?.length > 0 ? prefs.avoidAreas.map(a => a.name || a).join(', ') : 'None'}`;

            entDiv.innerHTML = html;
            output.appendChild(entDiv);
        }

        function displayConversation() {
            const output = document.getElementById('conversationOutput');
            output.innerHTML = '';

            if (!aiEngine) return;

            const history = aiEngine.conversationHistory;
            if (history.length === 0) {
                output.innerHTML = '<div class="output-item">No conversation yet</div>';
                return;
            }

            history.forEach((msg, idx) => {
                const div = document.createElement('div');
                div.className = `output-item ${msg.role === 'user' ? 'user' : 'ai'}`;
                
                let html = `<strong>${msg.role === 'user' ? 'üë§' : 'ü§ñ'}</strong> `;
                
                if (msg.role === 'user') {
                    html += msg.content;
                } else {
                    html += msg.content;
                    if (msg.intent) {
                        html += `<br><small>Intent: ${msg.intent} (${(msg.confidence * 100).toFixed(0)}%)</small>`;
                    }
                }
                
                div.innerHTML = html;
                output.appendChild(div);
            });

            output.scrollTop = output.scrollHeight;
        }

        function setExample(text) {
            document.getElementById('userInput').value = text;
            processMessage();
        }

        function clearHistory() {
            if (!aiEngine) return;
            aiEngine.clearHistory();
            document.getElementById('conversationOutput').innerHTML = '<div class="output-item">Conversation history cleared</div>';
            document.getElementById('analysisOutput').innerHTML = '<div class="output-item">History cleared. Ready for new messages.</div>';
            alert('Conversation history cleared!');
        }

        function updateStatus(text) {
            console.log(text);
        }

        // Allow Enter key to process
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('userInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    processMessage();
                }
            });
        });
    </script>
</body>
</html>
